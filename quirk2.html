<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>animateex</title>
  <!-- <meta http-equiv="refresh" content="1"> -->
  <style type="text/css">
    canvas{
      background-color: black;
    }
      body{
        margin: 0;
        overflow: hidden;
      }
      button{
        position: fixed;
        padding: 1em;
        bottom: 0;
        right: 0;
        background-color: grey;
        font-size: 2em;
        color: wheat;
        border-radius: 2em;
      }
  </style>
</head>
<body>
	<input type="range" id="rate" min="0" max="20" title="speed range" style="position: fixed;" oninput="dRate()">
  <button onclick="points.pop()" ondblclick="(event) => {event.stopPropagation();}">
    redo 
  </button>
  <canvas id="canvas" onclick="an(event);">
    <script>
      let can = document.getElementById("canvas"),
      innerw = window.innerWidth, innerh = window.innerHeight, px=innerw*.35, py = px, rate = Number(document.getElementById("rate").value),

      dRate = () => { rate = Number(document.getElementById("rate").value) }
      line = can.getContext("2d");
      can.width = innerw;
      can.height = innerh;

    

      class point{
        constructor(x, y){
          this.direction = ["-", "+", "-", "+", "-", "+", "-"];
          
          this.dir = this.direction[(Math.random() * this.direction.length).toFixed()]
          console.log(this.dir)
          
          this.ry = Number((Math.random() * rate).toFixed(1));
          this.rx = Number((Math.random() * rate).toFixed(1));
          
          this.ry = Number(this.dir + this.ry)
          this.rx = Number(this.dir + this.rx)

          this.x = x;
          this.y = y;
        }
        alter = () => {
          // this.x += (this.x >= (innerw/2))? this.rate: -this.rate;
          this.y += this.ry;
          this.x += this.rx;
        }
      }

      let points = new Array, num = Number(prompt("ðŸ”¢ ðŸ’Ž?"));

      for(x = 0; x < num; x++){
        points.push(new point(Number((Math.random() * innerw).toFixed(1)), Number((Math.random() * innerh).toFixed(1))))
      }

      class main{
        constructor(){

        }

        draw = () => {
          line.strokeStyle=`rgba(0, 0, 0, 1)`;
          line.fillStyle=`rgba(100, 190, 200, .12)`;
          line.lineWidth = 3;
          line.beginPath();
          for(let i=0;i<points.length;i++){
            for(let x=0;x<points.length;x++){
              line.lineTo(points[i].x, points[i].y);
              line.lineTo(points[x].x, points[x].y);
            line.fill();
            }
          }
          line.closePath();
          
          line.stroke();
        }
      }

      let body = new main();
      // body.draw();

      let update = () => {
        body.draw()
        for(let i = 0; i < points.length; i++){
          points[i].alter();
        }

        for(let i = 0; i < points.length; i++){
          if(points[i].x >= innerw-px){
            points[i].x = innerw - px;
            points[i].rx = points[i].rx * -1;
          }
          if(points[i].x <= px){
            points[i].x = px;
            points[i].rx = points[i].rx * -1;
          }

          if(points[i].y >= innerh-py){
            points[i].y = innerh-py;
            points[i].ry = points[i].ry * -1;
          }
          if(points[i].y <= py){
            points[i].y = py
            points[i].ry = points[i].ry * -1;
          }
          // if(points[i].x <= innerw/2){
          //   points[i].rate = points[i].rate * -1;
          // }

        }
/*
          for(let i = 0; i < points.length; i++){
            if(points[i].x > innerw-px){
            points[i].x = innerw - px * .2;
          }
          if(points[i].x <= px*.5){
            points[i].rx = points[i].rx * -1;
          }

          if(points[i].y >= innerh-px){
            points[i].ry = points[i].ry * -1;
          }
          if(points[i].y <= px){
            points[i].ry = points[i].ry * -1;
          }
          }*/
		
        // line.clearRect(0, 0, can.width, can.height);
        requestAnimationFrame(update);
        setTimeout(() => {
		innerw = window.innerWidth;
		can.width = innerw;
		
		innerh = window.innerHeight;
		can.height = innerh;
          line.clearRect(0, 0, can.width, can.height)
        }, 10)
      }
      update();


      let an = (e) => {
        points.push(new point(e.clientX, e.clientY))
      }
    </script>
  </canvas>
</body>
</html>